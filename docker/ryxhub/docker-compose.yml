version: "3.8"

services:
  # React Frontend (Vite)
  frontend:
    build:
      context: ../../ryxhub
      dockerfile: ../docker/ryxhub/Dockerfile.frontend
    container_name: ryx-hub-frontend
    ports:
      - "5173:5173"
    environment:
      - VITE_API_URL=http://localhost:8001
      - VITE_WS_URL=ws://localhost:8001/ws
    restart: unless-stopped
    networks:
      - ryxhub-network

  # FastAPI Backend (optional)
  backend:
    build:
      context: ../..
      dockerfile: docker/ryxhub/Dockerfile.backend
    container_name: ryx-hub-backend
    ports:
      - "8001:8001"
    volumes:
      - ../../data:/app/data
      - ../../configs:/app/configs
    environment:
      - VLLM_BASE_URL=http://host.docker.internal:8000
      - OLLAMA_BASE_URL=http://host.docker.internal:11434
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    networks:
      - ryxhub-network

networks:
  ryxhub-network:
    driver: bridge
